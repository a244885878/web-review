> 当页面包含多张图片时，HTTP 的加载表现涉及到多个方面，包括浏览器的并发请求限制、图片加载的优先级、以及一些优化策略。以下是详细的解释：

#### 1. 浏览器的并发连接限制：

- 浏览器为了避免对服务器造成过大压力，以及自身资源消耗过大，会对同一个域名下的并发 HTTP 连接数进行限制。
- 早期的 HTTP/1.1 协议，浏览器通常只允许对同一个域名建立 6-8 个并发连接。这意味着如果页面上有超过这个数量的图片需要加载，浏览器会排队等待，直到有连接空闲出来。
- HTTP/2 协议引入了多路复用，允许在单个 TCP 连接上同时发送多个请求，大大提高了并发性能，不再受限于连接数的限制。但即使是 HTTP/2，浏览器也可能对并发请求数进行一定的控制，以防止资源过度消耗。

#### 2. 图片加载的优先级：

- 浏览器会根据图片在 HTML 中的位置、是否在首屏（viewport）内等因素，赋予不同的加载优先级。
- 通常情况下，位于首屏内的图片会被优先加载，以尽快呈现页面的主要内容。
- 可以使用 `<img>` 标签的 `loading` 属性来控制图片的加载行为：
  - `lazy`：延迟加载，即图片只有在接近或进入视口时才加载。这是优化图片加载性能的常用方法。
  - `eager`：立即加载，无论图片是否在视口内都会立即加载。
  - `auto`：浏览器自行决定何时加载，这是默认值。

#### 3. 图片加载过程中的表现：

- 阻塞渲染： 在 HTTP/1.1 时代，由于连接数的限制，如果页面上有大量图片需要加载，后面的图片会阻塞前面图片的加载，直到有连接空闲出来。这会导致页面加载速度变慢，用户体验下降。
- DOMContentLoaded 事件： 浏览器在解析 HTML 文档并构建 DOM 树完成后，会触发 `DOMContentLoaded` 事件。此时，页面的基本结构已经呈现，但图片等外部资源可能尚未加载完成。
- load 事件： 当页面所有资源（包括图片、样式表、脚本等）都加载完成后，会触发 load 事件。

#### 4. 优化策略：

- 使用 CDN： 将图片等静态资源放在 CDN 上，利用 CDN 的分布式节点，可以加速资源加载，并减轻服务器的压力。
- 图片压缩： 使用合适的图片格式（如 WebP）和压缩算法，减小图片的文件大小，从而减少传输时间和带宽消耗。
- 图片懒加载： 使用 `loading="lazy"` 属性或第三方库实现图片懒加载，只加载用户可见的图片，提高页面加载速度和性能。
- 使用雪碧图（CSS Sprites）： 将多个小图标合并成一张大图，通过 CSS 的 `background-position` 属性来显示不同的图标，减少 HTTP 请求数。但现在 HTTP/2 普及，雪碧图的优势已经不如以前明显。
- 使用响应式图片： 使用 `<picture>` 元素或 `srcset` 属性，根据不同的屏幕尺寸和设备像素比提供不同尺寸的图片，优化用户体验并节省带宽。
- 预加载： 对于重要的图片，可以使用 `<link rel="preload">` 提前加载，提高加载优先级。

#### 总结：

在 HTTP/1.1 时代，多张图片加载容易受到浏览器并发连接数的限制，导致阻塞渲染。而 HTTP/2 的多路复用技术大大改善了这种情况。通过合理的优化策略，可以进一步提高图片加载性能，改善用户体验。
